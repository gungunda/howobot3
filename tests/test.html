<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>Лёшин планировщик — Тесты</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; padding: 16px; line-height: 1.4; }
    .ok { color: #0a7f2e; }
    .fail { color: #b00020; white-space: pre-wrap; }
    pre { background: #f6f8fa; padding: 12px; border-radius: 8px; max-width: 980px; overflow:auto; }
    .summary { margin-top: 12px; font-weight: 600; }
    button { padding: 8px 12px; border-radius: 8px; border: 1px solid #ccc; cursor: pointer; }
  </style>

  <!-- import map: подменяем /js/app.js на тестовую реализацию -->
  <script type="importmap">
  {
    "imports": {
      "/js/app.js": "/tests/mocks/app.test.js"
    }
  }
  </script>
</head>
<body>
  <h1>Лёшин планировщик — Тесты</h1>
  <button id="run">Run tests</button>
  <div id="out"></div>

  <script type="module">
    import { runAllTests } from "./test-suite.js";

    const btn = document.getElementById('run');
    const out = document.getElementById('out');

    btn.onclick = async () => {
      out.innerHTML = "";
      try {
        const report = await runAllTests();
        out.appendChild(report);
      } catch (e) {
        const pre = document.createElement('pre');
        pre.className = "fail";
        pre.textContent = "Runner crashed:\n" + (e?.stack || e);
        out.appendChild(pre);
      }
    };
  </script>
</body>
</html>
