# ============================
# PROJECT CONTEXT SUMMARY
# ============================

## üîπ –û–ë–©–ò–ï –î–ê–ù–ù–´–ï

**–ü—Ä–æ–µ–∫—Ç:** "–õ—ë—à–∏–Ω –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –¥–æ–º–∞—à–Ω–∏—Ö –∑–∞–¥–∞–Ω–∏–π"  
**–¢–∏–ø:** WebApp, –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–µ—Å—è –∫–∞–∫ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ Telegram.  

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**  
- HTML + CSS + JavaScript (ES-–º–æ–¥—É–ª–∏, –±–µ–∑ —Å–±–æ—Ä—â–∏–∫–∞, –±–µ–∑ backend)  
- Telegram.WebApp API (–≤ —Ç.—á. CloudStorage)  
- localStorage ‚Äî fallback –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏  
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: —á–∏—Å—Ç–∞—è, –º–æ–¥—É–ª—å–Ω–∞—è ("Clean Architecture" –≤ –¥—É—Ö–µ frontend-MVP)  

---

## üîπ –¶–ï–õ–¨

–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–µ, –ø–æ–Ω—è—Ç–Ω–æ–µ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —à–∫–æ–ª—å–Ω–∏–∫–∞, —á—Ç–æ–±—ã:

- –≤–∏–¥–µ—Ç—å –¥–æ–º–∞—à–∫—É ¬´–Ω–∞ –∑–∞–≤—Ç—Ä–∞¬ª;
- –æ—Ç–º–µ—á–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (—á–µ–∫–±–æ–∫—Å –∏ –ø—Ä–æ—Ü–µ–Ω—Ç—ã);
- –¥–µ–ª–∞—Ç—å "—Ä–∞–∑–≥—Ä—É–∑–∫—É" (–ø–µ—Ä–µ–Ω–æ—Å –∑–∞–¥–∞–Ω–∏–π –∑–∞—Ä–∞–Ω–µ–µ);
- —Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ñ–ª–∞–π–Ω –∏ –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞;
- –≤ –±—É–¥—É—â–µ–º ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ Telegram CloudStorage.

---

## üîπ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

```
index.html
assets/
‚îî‚îÄ‚îÄ styles.css
js/
‚îú‚îÄ‚îÄ app.js                # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ infra/
‚îÇ   ‚îî‚îÄ‚îÄ telegramEnv.js    # Storage —Å fallback'–æ–º (cloud/local)
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ repo.js           # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–∞–Ω–Ω—ã—Ö: schedule, overrides
‚îú‚îÄ‚îÄ ui/
‚îÇ   ‚îú‚îÄ‚îÄ events.js         # –ù–∞–≤–µ—à–∏–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ UI –∏ –≤—ã–∑—ã–≤–∞–µ—Ç usecases
‚îÇ   ‚îú‚îÄ‚îÄ view-dashboard.js # –≠–∫—Ä–∞–Ω –¥–Ω—è (–¥–∞—à–±–æ—Ä–¥)
‚îÇ   ‚îú‚îÄ‚îÄ view-calendar.js  # –ú–µ—Å—è—á–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å
‚îÇ   ‚îî‚îÄ‚îÄ view-schedule.js  # –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–µ–¥–µ–ª–∏ (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–æ–≤)
‚îî‚îÄ‚îÄ usecases/
    ‚îú‚îÄ‚îÄ addTaskToSchedule.js
    ‚îú‚îÄ‚îÄ adjustTaskPercentForDate.js
    ‚îú‚îÄ‚îÄ deleteTaskFromSchedule.js
    ‚îú‚îÄ‚îÄ editTaskInline.js
    ‚îú‚îÄ‚îÄ editTaskInSchedule.js
    ‚îú‚îÄ‚îÄ ensureTaskInOverrideForDate.js
    ‚îú‚îÄ‚îÄ forceCreateOverrideFromSchedule.js
    ‚îú‚îÄ‚îÄ resetToSchedule.js
    ‚îú‚îÄ‚îÄ toggleTaskDoneForDate.js
    ‚îú‚îÄ‚îÄ gcOldDates.js
    ‚îú‚îÄ‚îÄ setupSyncTriggers.js
    ‚îî‚îÄ‚îÄ syncNow.js
```

---

## üîπ –†–û–õ–ò –ú–û–î–£–õ–ï–ô

### js/app.js
–ì–ª–∞–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞.  
- –í—ã–∑—ã–≤–∞–µ—Ç `Storage.init()` –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (TelegramEnv).
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç `repo` –∏ `events.initUI()`.
- –î–µ—Ä–∂–∏—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: –≤—ã–±—Ä–∞–Ω–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞, –≤—ã–±—Ä–∞–Ω–Ω–∞—è –¥–∞—Ç–∞ –∏ —Ç.–¥.

---

### js/infra/telegramEnv.js
**–ì–ª–∞–≤–Ω–∞—è –ø—Ä–æ—Å–ª–æ–π–∫–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.**

- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –æ–±—ä–µ–∫—Ç `Storage` —Å –º–µ—Ç–æ–¥–∞–º–∏:
  ```js
  Storage.getItem(key)
  Storage.setItem(key, value)
  Storage.getKeys()
  Storage.init()
  Storage.getMode()
  ```
- –ü—Ä–∏ `Storage.init()`:
  - –µ—Å–ª–∏ WebApp –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `CloudStorage` ‚Üí —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ `"cloud"`;
  - –∏–Ω–∞—á–µ ‚Üí fallback –Ω–∞ `localStorage`.
- –ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –ª–æ–∫–∞–ª—å–Ω–æ (–≤ –±—Ä–∞—É–∑–µ—Ä–µ) Storage –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ `"local"`.
- –ü–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: `[Storage.init] mode resolved = local` / `cloud`.

---

### js/data/repo.js
**–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ª–æ–π —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏.**

–§—É–Ω–∫—Ü–∏–∏:
```js
loadSchedule(), saveSchedule(schedule)
loadDayOverride(dateKey), saveDayOverride(ov)
listOverrideDates()
```

**–î–∞–Ω–Ω—ã–µ:**

1. **–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–µ–¥–µ–ª–∏ (—à–∞–±–ª–æ–Ω):**
   ```js
   {
     monday:    [ { id, title, minutes, offloadDays[] }, ... ],
     tuesday:   [ ... ],
     ...
   }
   ```

2. **Override (—Å–Ω–∏–º–æ–∫ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –¥–∞—Ç—É):**
   ```js
   {
     dateKey: "2025-10-27",
     tasks: [
       { id, title, minutes, donePercent, done, meta },
       ...
     ],
     meta: {
       createdAt, updatedAt, deviceId, userAction
     }
   }
   ```

‚öôÔ∏è  Repo —Ä–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û —á–µ—Ä–µ–∑ `Storage.*` ‚Üí –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ CloudStorage.

---

### js/ui/view-dashboard.js
–û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç —ç–∫—Ä–∞–Ω **–î–Ω—è**:
- —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –¥–Ω—è (`ov.tasks`);
- –∫–Ω–æ–ø–∫–∏ `+10% / -10%`;
- —á–µ–∫–±–æ–∫—Å Done;
- inline-—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (‚úé);
- –±–ª–æ–∫ ¬´–†–∞–∑–≥—Ä—É–∑–∫–∞¬ª (offload-tasks);
- —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.

–ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–∏—á–µ–≥–æ —Å–∞–º ‚Äî —Ç–æ–ª—å–∫–æ –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç.

---

### js/ui/view-calendar.js
–û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –º–µ—Å—è—á–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å —Å –∫–ª–∞—Å—Å–∞–º–∏:
`.cal-day.today`, `.cal-day.selected`, `.cal-day.has-override`.

–ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±—Ä–∞—Ç—å –¥–µ–Ω—å ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞—à–±–æ—Ä–¥.

---

### js/ui/view-schedule.js
–û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–µ–¥–µ–ª–∏:
- –¥–Ω–∏ –∫–∞–∫ –∫–∞—Ä—Ç–æ—á–∫–∏;
- –∑–∞–¥–∞—á–∏ —Å –º–∏–Ω—É—Ç–∞–º–∏ –∏ offload-–¥–Ω—è–º–∏;
- inline-—Ä–µ–¥–∞–∫—Ç–æ—Ä –∑–∞–¥–∞—á–∏ (—Å –∫–Ω–æ–ø–∫–∞–º–∏ ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å / –û—Ç–º–µ–Ω–∏—Ç—å¬ª);
- offload-—á–µ–∫–±–æ–∫—Å—ã (–ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å ‚Äî disabled).

---

### js/ui/events.js
–ù–∞–≤–µ—à–∏–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤:
- —á–µ–∫–±–æ–∫—Å Done ‚Üí `toggleTaskDoneForDate`
- +10% / -10% ‚Üí `adjustTaskPercentForDate`
- ‚úé —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ‚Üí `editTaskInline`
- –∫–Ω–æ–ø–∫–∏ –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ ‚Üí `addTaskToSchedule`, `editTaskInSchedule`, `deleteTaskFromSchedule`
- "–°–±—Ä–æ—Å–∏—Ç—å –¥–µ–Ω—å" ‚Üí `resetToSchedule`
- –ø–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏: –î–µ–Ω—å / –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ / –ö–∞–ª–µ–Ω–¥–∞—Ä—å
- –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—é (–∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–Ω—è)

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `refreshDashboard(state)`.

---

## üîπ USECASES (–¢–ï–ö–£–©–ê–Ø –°–¢–†–£–ö–¢–£–†–ê)

–í—Å—è –ø–∞–ø–∫–∞ `js/usecases/` –±—ã–ª–∞ –æ—á–∏—â–µ–Ω–∞ –æ—Ç —Å—Ç–∞—Ä—ã—Ö –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ (`overrideRepo`, `progress`, `closed` –∏ —Ç.–ø.).
–û—Å—Ç–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ —á–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, —Ä–∞–±–æ—Ç–∞—é—â–∏–µ —á–µ—Ä–µ–∑ `repo.js`.

### üíæ –†–∞–±–æ—Ç–∞ —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º (—à–∞–±–ª–æ–Ω)
- `addTaskToSchedule` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ.
- `editTaskInSchedule` ‚Äî –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ (–Ω–∞–∑–≤–∞–Ω–∏–µ, –º–∏–Ω—É—Ç—ã, offloadDays).
- `deleteTaskFromSchedule` ‚Äî —É–¥–∞–ª–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç –∏–∑ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è.

### üìÖ –†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –¥–Ω—ë–º (override)
- `ensureTaskInOverrideForDate` ‚Äî –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ override –¥–ª—è –¥–∞—Ç—ã —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ø–∞–º—è—Ç–∏ (–±–µ–∑ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è), –∏ —á—Ç–æ –≤ –Ω—ë–º –µ—Å—Ç—å –∑–∞–¥–∞—á–∞ —Å taskId.
- `adjustTaskPercentForDate` ‚Äî +10% / -10% –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.
- `toggleTaskDoneForDate` ‚Äî —á–µ–∫–±–æ–∫—Å ¬´—Å–¥–µ–ª–∞–Ω–æ¬ª (0% ‚Üî 100%).
- `editTaskInline` ‚Äî –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–ª–∏ –º–∏–Ω—É—Ç—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏ –¥–Ω—è.
- `resetToSchedule` ‚Äî –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –¥–µ–Ω—å –∏–∑ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (–∂—ë—Å—Ç–∫–∏–π —Å–±—Ä–æ—Å, –≤—ã–∑—ã–≤–∞–µ—Ç `forceCreateOverrideFromSchedule`).
- `forceCreateOverrideFromSchedule` ‚Äî —Å–æ–∑–¥–∞—Ç—å override –° –ù–£–õ–Ø –∏ —Å—Ä–∞–∑—É —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å (—Ç–æ–ª—å–∫–æ –ø–æ —è–≤–Ω–æ–º—É –¥–µ–π—Å—Ç–≤–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è).

### üßπ –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ
- `gcOldDates` ‚Äî –∑–∞–≥–ª—É—à–∫–∞: –≤ –±—É–¥—É—â–µ–º —á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ override-–¥–∞—Ç—ã.
- `setupSyncTriggers` ‚Äî –∑–∞–≥–ª—É—à–∫–∞ –ø–æ–¥ –±—É–¥—É—â—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é.
- `syncNow` ‚Äî –∑–∞–≥–ª—É—à–∫–∞ –ø–æ–¥ –æ–±–ª–∞—á–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏.

---

## üîπ –ú–û–î–ï–õ–¨ –î–ê–ù–ù–´–•

### Task (–≤–Ω—É—Ç—Ä–∏ schedule –∏–ª–∏ override)
```js
{
  id: string,
  title: string,
  minutes: number,
  donePercent: number,
  done: boolean,
  offloadDays?: string[],
  meta?: object
}
```

### DayOverride
```js
{
  dateKey: "YYYY-MM-DD",
  tasks: Task[],
  meta: {
    createdAt: ISODate,
    updatedAt: ISODate,
    userAction: string,
    deviceId: string | null
  }
}
```

### Schedule (–Ω–µ–¥–µ–ª—å–Ω—ã–π —à–∞–±–ª–æ–Ω)
```js
{
  monday: Task[],
  tuesday: Task[],
  ...
}
```

---

## üîπ –ë–ò–ó–ù–ï–°-–ü–†–ê–í–ò–õ–ê (–∫–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã)

1. **Override —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ–º –¥–µ–π—Å—Ç–≤–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.**  
   –ü—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä—ã—Ç—å –¥–µ–Ω—å ‚Üí –Ω–µ –¥–æ–ª–∂–Ω–æ –Ω–∏—á–µ–≥–æ –ø–∏—Å–∞—Ç—å –≤ Storage.

2. **–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ (schedule) ‚Äî —ç—Ç–æ —à–∞–±–ª–æ–Ω.**  
   –û–Ω–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è –µ—Å—Ç—å –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏, –Ω–æ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å.

3. **Override (–¥–Ω–µ–≤–Ω–æ–π —Å–Ω–∏–º–æ–∫) ‚Äî —ç—Ç–æ "–∫–æ–ø–∏—è –Ω–∞ –¥–∞—Ç—É".**  
   –û–Ω–æ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–¥–∞—á (–ø—Ä–æ–≥—Ä–µ—Å—Å, –æ—Ç–º–µ—Ç–∫–∏ –∏ —Ç.–¥.).

4. **OffloadDays** ‚Äî —ç—Ç–æ —Å–ø–∏—Å–æ–∫ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –¥–Ω–µ–π, –∫–æ–≥–¥–∞ –∑–∞–¥–∞—á—É –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞—Ä–∞–Ω–µ–µ.  
   - –í —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ `offloadDays[]` –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è.  
   - –í override –ø–æ–ª–µ `offloadDays` –≤—Å–µ–≥–¥–∞ `null` (–æ–Ω–æ —É–∂–µ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–æ).

5. **Storage** —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –¥–≤—É—Ö —Ä–µ–∂–∏–º–∞—Ö:
   - `"local"` ‚Äî localStorage (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏);
   - `"cloud"` ‚Äî Telegram CloudStorage (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞, –∫–æ–≥–¥–∞ API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è).

6. **repo.js** ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ç–æ—á–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º.  
   –ù–∏–∫—Ç–æ –Ω–µ –ø–∏—à–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –≤ localStorage.

---

## üîπ –¢–ï–ö–£–©–ò–ô –°–û–°–¢–û–Ø–ù–ò–ï (27.10.2025)

‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ:
- –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞—á —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ;
- override —Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö;
- "—Ä–∞–∑–≥—Ä—É–∑–∫–∞" —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–µ–Ω—å;
- –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–∏—Å—Ç—ã–π (`view-*` —Ñ–∞–π–ª—ã –±–µ–∑ –¥—É–±–ª–µ–π);
- —Å—Ç–∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã (`assets/styles.css`), –≤—Å—ë –≤—ã—Ä–æ–≤–Ω–µ–Ω–æ.

üßπ –£–¥–∞–ª–µ–Ω–æ:
- –≤—Å–µ `render-*` –∏ —Å—Ç–∞—Ä—ã–µ `view-week.js`;
- —Å—Ç–∞—Ä—ã–µ usecases (`ensureOverride.js`, `computeDayStats.js`, `deleteTaskForDate.js`, –∏ –¥—Ä.);
- –º—É—Å–æ—Ä–Ω—ã–µ —Å—Ç–∏–ª–∏ (–≤—ã–Ω–µ—Å–µ–Ω—ã –≤ `/* LEGACY */` –±–ª–æ–∫ –∏ –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è).

---

## üîπ –ü–†–ê–í–ò–õ–ê –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–Ø –° –ò–ò

1. –ö–æ–≥–¥–∞ —Ç–µ–±–µ –Ω—É–∂–Ω—ã —Ñ–∞–π–ª—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî –ø–µ—Ä–µ—á–∏—Å–ª—è–π –∏—Ö –¢–ï–ö–°–¢–û–ú —Å –ø—É—Ç—è–º–∏ –æ—Ç –∫–æ—Ä–Ω—è, –Ω–∞–ø—Ä–∏–º–µ—Ä:
   ```
   index.html
   assets/styles.css
   js/app.js
   js/ui/events.js
   ```
   (–≠—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±—Ä–∞—Ç—å –±–∞–Ω–¥–ª –Ω—É–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.)

2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏—Å—ã–ª–∞–µ—Ç **bundle_YYYYMMDD_HHmmss.txt**, —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç–æ–º `make-plain.ps1`.  
   –§–æ—Ä–º–∞—Ç:
   ```
   FILE_INDEX_START
   /index.html
   /js/app.js
   ...
   FILE_INDEX_END
   // /index.html
   <–∫–æ–¥>
   // /js/app.js
   <–∫–æ–¥>
   ...
   ```

3. –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç —á–∏—Ç–∞–µ—Ç bundle, –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã, –ø–æ—Ç–æ–º —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç **patch.txt** –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
   ```
   ===FILE_START===
   PATH: js/ui/view-calendar.js
   -----8<-----
   <–Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è —Ñ–∞–π–ª–∞ —Ü–µ–ª–∏–∫–æ–º>
   -----8<-----
   ===FILE_END===
   ```
   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–º–µ–Ω—è–µ—Ç –ø–∞—Ç—á —á–µ—Ä–µ–∑ `apply-patch.cmd`.

4. –¢–æ–ª—å–∫–æ –ø–æ–ª–Ω—ã–µ —Ñ–∞–π–ª—ã, –Ω–∏–∫–∞–∫–∏—Ö —Ä—É—á–Ω—ã—Ö –≤—Å—Ç–∞–≤–æ–∫, —á—Ç–æ–±—ã –Ω–µ –≤–æ–∑–Ω–∏–∫–∞–ª–æ "–≤–∏–Ω–µ–≥—Ä–µ—Ç–∞ –≤–µ—Ä—Å–∏–π".

5. –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã —Å—Ç—Ä–æ–≥–æ —Å–ª–µ–¥–æ–≤–∞—Ç—å –∫–æ–¥—Å—Ç–∞–π–ª—É –ø—Ä–æ–µ–∫—Ç–∞:
   - —á–∏—Ç–∞–±–µ–ª—å–Ω—ã–π –∫–æ–¥,
   - –ø–æ–Ω—è—Ç–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è junior-—É—Ä–æ–≤–Ω—è,
   - –ø–æ—à–∞–≥–æ–≤–∞—è –ª–æ–≥–∏–∫–∞, –±–µ–∑ –∏–∑–ª–∏—à–Ω–µ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏.

---

## üîπ –ì–õ–ê–í–ù–ê–Ø –õ–û–ì–ò–ö–ê –ü–û–¢–û–ö–ê –î–ê–ù–ù–´–•

```
UI (events.js)
   ‚Üì
usecase (toggleTaskDoneForDate / adjustTaskPercentForDate / editTaskInline ...)
   ‚Üì
repo.js (loadDayOverride / saveDayOverride)
   ‚Üì
Storage (telegramEnv.js ‚Üí CloudStorage –∏–ª–∏ localStorage)
```

---

## üîπ –ì–õ–ê–í–ù–´–ô –ü–†–ò–ù–¶–ò–ü –ù–ê –ë–£–î–£–©–ï–ï

> **‚Äú–ù–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –±–µ–∑ —è–≤–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è.‚Äù**  
> –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –º–æ–∂–µ—Ç –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å —É–ª—É—á—à–µ–Ω–∏—è, –Ω–æ –Ω–µ –≤–Ω–µ–¥—Ä—è—Ç—å –∏—Ö –±–µ–∑ –æ–¥–æ–±—Ä–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

## üîπ –ß–¢–û –î–ï–õ–ê–¢–¨ –ï–°–õ–ò –ù–ê–î–û –ü–ï–†–ï–ù–ï–°–¢–ò –ü–†–û–ï–ö–¢ –í –ù–û–í–´–ô –ß–ê–¢

1. –°–∫–æ–ø–∏—Ä—É–π —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç —Ü–µ–ª–∏–∫–æ–º –≤ –Ω–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ —á–∞—Ç–∞.  
2. –ù–∞–ø–∏—à–∏: ¬´–í–æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞, –ø—Ä–æ–¥–æ–ª–∂–∞–π —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–Ω—å—à–µ¬ª.  
3. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤—å —Å–≤–µ–∂–∏–π `bundle_*.txt` —Å –∫–æ–¥–æ–º.  
4. –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –º–æ–∂–µ—Ç —Å—Ä–∞–∑—É –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ `patch.txt`.

---

# END OF CONTEXT
